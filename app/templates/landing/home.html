{% extends "landing/base_landing.html" %}

{% block title %}F.I.S.M Technology SRL | Redefiniendo la Excelencia Tecnológica{% endblock %}

{% block meta_description %}Descubre las mejores laptops y equipos de computación en República Dominicana. Garantía
oficial, soporte técnico especializado y las mejores marcas del mercado.{% endblock %}

{% block extra_css %}
<!-- Phosphor Icons -->
<script src="https://unpkg.com/@phosphor-icons/web"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link
    href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=Syne:wght@700;800&display=swap"
    rel="stylesheet">

<style>
    :root {
        --lx-accent: #7c3aed;
        --lx-accent-hover: #6d28d9;
    }

    /* Animaciones suaves */
    .reveal {
        opacity: 0;
        transform: translateY(20px);
        transition: all 0.8s cubic-bezier(0.2, 0.8, 0.2, 1);
    }

    .reveal.active {
        opacity: 1;
        transform: translateY(0);
    }

    /* Ajustes para el Hero */
    .hero-gradient {
        background: radial-gradient(circle at 50% 50%, rgba(124, 58, 237, 0.05) 0%, transparent 70%);
    }

    .fade-mask {
        mask-image: linear-gradient(to right, transparent, black 15%, black 85%, transparent);
    }

    /* ── Product Card V2 (Sincronizado con Catalog) ── */
    .product-card-v2 {
        background: var(--surface-primary, #fff);
        border: 1px solid var(--border-subtle);
        border-radius: var(--radius-lg, 20px);
        overflow: hidden;
        transition: all 0.4s cubic-bezier(0.2, 0.8, 0.2, 1);
        position: relative;
    }

    .product-card-v2:hover {
        transform: translateY(-6px);
        box-shadow: 0 24px 48px -12px rgba(124, 58, 237, 0.12);
        border-color: rgba(124, 58, 237, 0.3);
    }

    /* ── Brand Highlight ── */
    .brand-marquee-item {
        filter: grayscale(1);
        opacity: 0.5;
        transition: all 0.4s ease;
    }

    .brand-marquee-item:hover {
        filter: grayscale(0);
        opacity: 1;
        color: var(--primary);
        text-shadow: 0 0 20px rgba(124, 58, 237, 0.4);
        transform: scale(1.1);
    }

    [data-theme="dark"] .product-card-v2 {
        background: var(--surface-primary, #0e0c18);
    }

    /* ── Bg Main Definition ── */
    .luxera-marquee-bg {
        background-color: #0c0a1a !important;
    }

    [data-theme="dark"] .luxera-marquee-bg {
        background-color: #05040a !important;
    }
</style>
{% endblock %}

{% block content %}
<div class="overflow-x-hidden">
    <!-- Hero Section -->
    <section class="relative min-h-[90vh] flex items-center pt-16 pb-16 lg:pt-20 lg:pb-24 hero-gradient">
        <div class="container-custom relative z-10">
            <div class="flex flex-col lg:grid lg:grid-cols-2 gap-8 lg:gap-8 items-center text-center lg:text-left">
                <!-- Badge & Title (order-1 on mobile) -->
                <div class="w-full lg:order-1 space-y-4 reveal active">
                    <div
                        class="inline-flex items-center gap-2 px-4 py-1.5 rounded-full bg-primary/10 border border-primary/20 text-primary font-bold text-xs uppercase tracking-wider">
                        <i class="fas fa-bolt text-[10px]"></i> Tecnología de Vanguardia
                    </div>

                    <h1 class="hero-title text-main">
                        <span id="hero-brand" class="block">Cargando...</span>
                        <span id="hero-model" class="text-gradient block">Excelencia</span>
                    </h1>

                    <p id="hero-desc" class="subtitle text-secondary lg:mx-0">
                        Potencia y rendimiento excepcional para profesionales exigentes. Descubre nuestra selección
                        exclusiva.
                    </p>
                </div>

                <!-- Image (order-2 on mobile, positioned in grid column 2 on desktop) -->
                <div class="relative flex justify-center items-center w-full lg:order-2 lg:row-span-3 reveal active"
                    style="transition-delay: 0.2s;">
                    <div id="hero-image-wrap"
                        class="relative z-10 w-full max-w-lg lg:max-w-xl transition-all duration-700 aspect-[16/10] flex items-center justify-center p-0">
                        <!-- Image Container: pure white, no shadow, max size -->
                        <div
                            class="relative w-full h-full rounded-3xl overflow-hidden bg-white border border-border-subtle shadow-none flex items-center justify-center group">
                            <img id="hero-image" src="" alt="Featured Product"
                                class="w-full h-full object-contain transition-all duration-700 group-hover:scale-105">

                            <!-- Fallback UI inside the container -->
                            <div id="hero-fallback"
                                class="hidden absolute inset-0 flex-col items-center justify-center text-tertiary/20 animate-pulse">
                                <i class="fas fa-laptop text-[6rem] lg:text-[8rem] mb-4"></i>
                                <span class="text-[10px] uppercase tracking-widest font-bold opacity-50">Visual no
                                    disponible</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Modern Carousel Controls (for entire hero) -->
            <div id="hero-controls" class="{% if featured_laptops|length <= 1 %}hidden{% endif %}">
                <!-- Desktop: Side Arrows (subtle, appear on hover) -->
                <button onclick="manualPrev()" aria-label="Anterior"
                    class="hidden lg:flex absolute left-4 top-1/2 -translate-y-1/2 w-12 h-12 items-center justify-center rounded-full bg-white/60 backdrop-blur-md border border-purple-100/50 text-purple-600 shadow-lg opacity-0 hover:opacity-100 hover:bg-white/95 hover:scale-110 hover:shadow-xl transition-all duration-300 z-30 group">
                    <i class="ph-bold ph-caret-left text-xl group-hover:-translate-x-0.5 transition-transform"></i>
                </button>
                <button onclick="manualNext()" aria-label="Siguiente"
                    class="hidden lg:flex absolute right-4 top-1/2 -translate-y-1/2 w-12 h-12 items-center justify-center rounded-full bg-white/60 backdrop-blur-md border border-purple-100/50 text-purple-600 shadow-lg opacity-0 hover:opacity-100 hover:bg-white/95 hover:scale-110 hover:shadow-xl transition-all duration-300 z-30 group">
                    <i class="ph-bold ph-caret-right text-xl group-hover:translate-x-0.5 transition-transform"></i>
                </button>

                <!-- Mobile & Desktop: Dot Indicators at bottom (compact, non-obstructive) -->
                <div
                    class="relative w-full justify-center mt-6 mb-2 lg:absolute lg:w-auto lg:my-0 lg:bottom-8 lg:left-1/2 lg:-translate-x-1/2 flex items-center gap-3 z-30">
                    <!-- Mobile Arrows (compact) -->
                    <button onclick="manualPrev()" aria-label="Anterior"
                        class="lg:hidden w-8 h-8 flex items-center justify-center rounded-full bg-white/90 backdrop-blur-md border border-purple-100/80 text-purple-600 shadow-md hover:bg-white active:scale-95 transition-all">
                        <i class="ph-bold ph-caret-left text-sm"></i>
                    </button>

                    <!-- Dot Indicators (refined, compact) -->
                    <div id="dot-indicators"
                        class="flex items-center gap-2 px-3 py-2 rounded-full bg-white/90 backdrop-blur-md border border-purple-100/80 shadow-md">
                        {% for laptop in featured_laptops %}
                        <button onclick="goToSlide({{ loop.index0 }})" aria-label="Ir a producto {{ loop.index }}"
                            class="carousel-dot w-1.5 h-1.5 rounded-full transition-all duration-300 {% if loop.first %}bg-purple-600 w-6{% else %}bg-gray-400 hover:bg-purple-400{% endif %}"
                            data-index="{{ loop.index0 }}">
                        </button>
                        {% endfor %}
                    </div>

                    <!-- Mobile Arrows (compact) -->
                    <button onclick="manualNext()" aria-label="Siguiente"
                        class="lg:hidden w-8 h-8 flex items-center justify-center rounded-full bg-white/90 backdrop-blur-md border border-purple-100/80 text-purple-600 shadow-md hover:bg-white active:scale-95 transition-all">
                        <i class="ph-bold ph-caret-right text-sm"></i>
                    </button>
                </div>
            </div>

            <!-- Specs Grid (order-3 on mobile) -->
            <div class="w-full lg:order-3 reveal active">
                <!-- Specs Quick View (CPU, GPU, Pantalla, RAM, SSD) -->
                <div
                    class="grid grid-cols-2 sm:grid-cols-5 gap-2 sm:gap-3 rounded-2xl overflow-hidden max-w-2xl mx-auto lg:mx-0">
                    <div
                        class="bg-surface-primary p-4 flex flex-col items-center gap-2 rounded-xl border border-border-subtle">
                        <span class="text-[9px] font-bold text-tertiary uppercase tracking-widest">CPU</span>
                        <span id="spec-cpu"
                            class="text-[10px] font-bold text-main px-1 text-center leading-tight">--</span>
                    </div>
                    <div
                        class="bg-surface-primary p-4 flex flex-col items-center gap-2 rounded-xl border border-border-subtle">
                        <span class="text-[9px] font-bold text-tertiary uppercase tracking-widest">GPU</span>
                        <span id="spec-gpu"
                            class="text-[10px] font-bold text-main px-1 text-center leading-tight">--</span>
                    </div>
                    <div
                        class="bg-surface-primary p-4 flex flex-col items-center gap-2 rounded-xl border border-border-subtle">
                        <span class="text-[9px] font-bold text-tertiary uppercase tracking-widest">Pantalla</span>
                        <span id="spec-screen"
                            class="text-[10px] font-bold text-main px-1 text-center leading-tight">--</span>
                    </div>
                    <div
                        class="bg-surface-primary p-4 flex flex-col items-center gap-2 rounded-xl border border-border-subtle">
                        <span class="text-[9px] font-bold text-tertiary uppercase tracking-widest">RAM</span>
                        <span id="spec-ram"
                            class="text-[10px] font-bold text-main px-1 text-center leading-tight">--</span>
                    </div>
                    <div
                        class="bg-surface-primary p-4 flex flex-col items-center gap-2 rounded-xl border border-border-subtle">
                        <span class="text-[9px] font-bold text-tertiary uppercase tracking-widest">SSD</span>
                        <span id="spec-ssd"
                            class="text-[10px] font-bold text-main px-1 text-center leading-tight">--</span>
                    </div>
                </div>
            </div>

            <!-- Price & CTA (order-4 on mobile) -->
            <div class="w-full lg:order-4 reveal active mt-8 lg:mt-0">
                <div class="flex flex-col sm:flex-row items-center gap-6 lg:justify-start">
                    <div class="text-left w-full sm:w-auto">
                        <div id="price-old" class="text-sm text-tertiary line-through opacity-60 hidden">RD$ --
                        </div>
                        <div class="text-4xl font-extrabold text-main">
                            <span class="text-lg font-bold mr-1">RD$</span><span id="price-new">--</span>
                        </div>
                    </div>
                    <a id="buy-btn" href="#" class="btn-primary w-full sm:w-auto group">
                        Me interesa <i
                            class="fas fa-arrow-right ml-2 text-xs transition-transform group-hover:translate-x-1"></i>
                    </a>
                </div>
            </div>
        </div>
</div>

<!-- Background Decor -->
<div class="absolute top-1/4 right-0 w-64 h-64 bg-primary/5 blur-[120px] rounded-full"></div>
<div class="absolute bottom-1/4 left-0 w-96 h-96 bg-accent/5 blur-[150px] rounded-full"></div>
</section>

<!-- Brands Marquee -->
<div class="luxera-marquee-bg bg-[#0c0a1a] py-8 overflow-hidden border-y border-white/5 relative fade-mask">
    <div class="flex whitespace-nowrap animate-lxMarquee hover:[animation-play-state:paused] will-change-transform">
        {% for i in range(2) %}
        <div class="flex items-center gap-20 px-10">
            {% if brands %}
            {% for brand in brands %}
            <a href="{{ url_for('public.catalog', brand=brand.name) }}"
                class="brand-marquee-item flex items-center gap-4 group">
                <span
                    class="text-white font-heading text-xl font-extrabold tracking-tighter uppercase group-hover:text-primary transition-colors">
                    {{ brand.name }}
                </span>
            </a>
            {% endfor %}
            {% else %}
            <span class="text-white/20 font-heading text-xl font-extrabold uppercase tracking-widest">F.I.S.M Technology
                SRL
                Premium</span>
            {% endif %}
        </div>
        {% endfor %}
    </div>
</div>

<!-- Featured Products -->
<section id="catalog" class="section-spacing bg-surface-tertiary">
    <div class="container-custom">
        <div class="flex flex-col md:flex-row justify-between items-end mb-12 gap-6 reveal">
            <div class="space-y-4 max-w-xl text-center md:text-left">
                <span class="text-primary font-bold text-xs uppercase tracking-widest">Favoritos de la
                    Temporada</span>
                <h2 class="section-title text-main">Hardware de Selección</h2>
            </div>
            <a href="{{ url_for('public.catalog') }}" class="btn-secondary group">
                Ver todo el catálogo <i
                    class="fas fa-arrow-right ml-2 text-xs transition-transform group-hover:translate-x-1"></i>
            </a>
        </div>

        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 reveal">
            {% if featured_laptops %}
            {% for laptop in featured_laptops[:4] %}
            <article class="product-card-v2 group flex flex-col h-full animate-fade-in-up"
                style="transition-delay: {{ loop.index0 * 0.1 }}s">
                <a href="{{ url_for('public.product_detail', id=laptop.id) }}" class="block flex-1 flex flex-col">
                    <!-- Image Container -->
                    <div class="relative h-52 w-full bg-white flex items-center justify-center p-6 overflow-hidden">
                        {% if laptop.images and laptop.images|length > 0 %}
                        {% set cover = laptop.images|selectattr('is_cover', 'equalto', True)|first or
                        laptop.images[0] %}
                        <img src="{{ url_for('static', filename=cover.image_path) }}" alt="{{ laptop.display_name }}"
                            class="w-full h-full object-contain transition-transform duration-500 group-hover:scale-110">
                        {% else %}
                        <i class="fas fa-laptop text-tertiary/20 text-6xl"></i>
                        {% endif %}

                        <!-- Badges -->
                        <div class="absolute top-3 left-3 flex flex-col gap-1.5">
                            {% if laptop.discount_price and laptop.discount_price < laptop.sale_price %} <span
                                class="px-2.5 py-1 bg-purple-500/15 text-purple-600 border border-purple-500/20 rounded-full text-[10px] font-extrabold uppercase tracking-wide backdrop-blur-md">
                                Oferta</span>
                                {% endif %}
                                {% if laptop.condition == 'new' %}
                                <span
                                    class="px-2.5 py-1 bg-emerald-500/15 text-emerald-600 border border-emerald-500/20 rounded-full text-[10px] font-extrabold uppercase tracking-wide backdrop-blur-md">Nuevo</span>
                                {% elif laptop.condition == 'used' %}
                                <span
                                    class="px-2.5 py-1 bg-amber-500/15 text-amber-600 border border-amber-500/20 rounded-full text-[10px] font-extrabold uppercase tracking-wide backdrop-blur-md">Usado</span>
                                {% endif %}
                        </div>
                    </div>

                    <!-- Info -->
                    <div class="p-5 flex-1 flex flex-col">
                        <div class="mb-4 flex items-center gap-2">
                            <span class="text-[12px] font-bold text-primary uppercase tracking-widest">
                                {{ laptop.brand.name if laptop.brand else 'Premium' }}
                            </span>
                            <span
                                class="text-[12px] font-semibold text-[var(--text-sub)] opacity-60 group-hover:opacity-100 group-hover:text-purple-600 transition-all duration-300">
                                {{ laptop.model.name if laptop.model else '' }}
                            </span>
                        </div>

                        <!-- Specs List -->
                        <ul class="space-y-2.5 mb-6 text-[11px] text-[var(--text-sub)]">
                            <li class="flex items-center gap-2.5">
                                <i class="ph-bold ph-cpu text-purple-600 text-sm w-4"></i>
                                <span class="line-clamp-1">{{ laptop.processor_full_name or laptop.processor.name
                                    }}</span>
                            </li>
                            <li class="flex items-center gap-2.5">
                                <i class="ph-bold ph-graphics-card text-purple-600 text-sm w-4"></i>
                                <span class="line-clamp-1">{{ laptop.discrete_gpu_full_name or
                                    laptop.onboard_gpu_full_name or laptop.graphics_card.name or 'Integrada'
                                    }}</span>
                            </li>
                            <li class="flex items-center gap-2.5">
                                <i class="ph-bold ph-monitor text-purple-600 text-sm w-4"></i>
                                <span class="line-clamp-1">{{ laptop.screen_full_name or laptop.screen.name
                                    }}</span>
                            </li>
                            <li class="flex items-center gap-2.5">
                                <i class="ph-bold ph-hard-drives text-purple-600 text-sm w-4"></i>
                                <span class="line-clamp-1">{{ laptop.storage_full_name or laptop.storage.name
                                    }}</span>
                            </li>
                            <li class="flex items-center gap-2.5">
                                <i class="ph-bold ph-memory text-purple-600 text-sm w-4"></i>
                                <span class="line-clamp-1">{{ laptop.ram_full_name or laptop.ram.name }}</span>
                            </li>
                        </ul>

                        <!-- Price + Actions -->
                        <div
                            class="mt-auto pt-4 border-t border-[var(--border-subtle)] flex items-center justify-between">
                            <div>
                                {% if laptop.discount_price and laptop.discount_price < laptop.sale_price %} <span
                                    class="block text-[10px] text-[var(--text-sub)] line-through">
                                    RD$ {{ "{:,.0f}".format(laptop.sale_price) }}
                                    </span>
                                    {% endif %}
                                    <span class="text-base font-bold text-[var(--text-main)]">
                                        RD$ {{ "{:,.0f}".format(laptop.discount_price or laptop.sale_price) }}
                                    </span>
                            </div>
                            <div class="flex gap-2">
                                <div
                                    class="w-8 h-8 rounded-full bg-purple-600 text-white flex items-center justify-center hover:bg-purple-700 transition-colors shadow-md">
                                    <i class="ph-bold ph-arrow-right text-xs"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </a>
            </article>
            {% endfor %}
            {% endif %}
        </div>
    </div>
</section>

<!-- Features -->
<section class="section-spacing bg-white">
    <div class="container-custom">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
            <!-- Feature 1 -->
            <div
                class="p-8 rounded-3xl bg-surface-secondary border border-border-subtle reveal hover:shadow-xl transition-all duration-300">
                <div
                    class="w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary text-xl mb-6">
                    <i class="fas fa-shield-alt"></i>
                </div>
                <h3 class="font-bold text-main mb-3">Garantía Real</h3>
                <p class="text-sm text-secondary leading-relaxed">Todos nuestros equipos incluyen garantía oficial
                    de 1 año con respaldo directo.</p>
            </div>
            <!-- Feature 2 -->
            <div class="p-8 rounded-3xl bg-surface-secondary border border-border-subtle reveal hover:shadow-xl transition-all duration-300"
                style="transition-delay: 0.1s">
                <div
                    class="w-12 h-12 rounded-2xl bg-accent/10 flex items-center justify-center text-accent text-xl mb-6">
                    <i class="fas fa-shipping-fast"></i>
                </div>
                <h3 class="font-bold text-main mb-3">Envío Local</h3>
                <p class="text-sm text-secondary leading-relaxed">Entregas seguras en toda la isla con seguimiento
                    en tiempo real de tu pedido.</p>
            </div>
            <!-- Feature 3 -->
            <div class="p-8 rounded-3xl bg-surface-secondary border border-border-subtle reveal hover:shadow-xl transition-all duration-300"
                style="transition-delay: 0.2s">
                <div
                    class="w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary text-xl mb-6">
                    <i class="fas fa-credit-card"></i>
                </div>
                <h3 class="font-bold text-main mb-3">Facilidades</h3>
                <p class="text-sm text-secondary leading-relaxed">Aceptamos todos los métodos de pago y ofrecemos
                    opciones de financiamiento.</p>
            </div>
            <!-- Feature 4 -->
            <div class="p-8 rounded-3xl bg-surface-secondary border border-border-subtle reveal hover:shadow-xl transition-all duration-300"
                style="transition-delay: 0.3s">
                <div
                    class="w-12 h-12 rounded-2xl bg-accent/10 flex items-center justify-center text-accent text-xl mb-6">
                    <i class="fas fa-headset"></i>
                </div>
                <h3 class="font-bold text-main mb-3">Soporte Expert</h3>
                <p class="text-sm text-secondary leading-relaxed">Contamos con técnicos certificados para brindarte
                    el mejor servicio post-venta.</p>
            </div>
        </div>
    </div>
</section>

<!-- Newsletter Simple -->
<section class="section-spacing">
    <div class="container-custom">
        <div
            class="luxera-marquee-bg bg-[#0c0a1a] rounded-[2.5rem] p-12 lg:p-24 relative overflow-hidden flex flex-col items-center text-center reveal">
            <div class="relative z-10 max-w-2xl space-y-6">
                <h2 class="section-title text-white">¿Buscas algo específico?</h2>
                <p class="text-white/60 subtitle">Suscríbete para recibir alertas de nuevos ingresos, ofertas flash
                    y guías tecnológicas exclusivas de Luxera.</p>
                <form class="flex flex-col sm:flex-row gap-4 w-full pt-4">
                    <input type="email" placeholder="Tu correo electrónico"
                        class="input-v2 flex-1 !bg-white/5 !border-white/10 !text-white !placeholder-white/30 focus:!border-primary">
                    <button type="submit" class="btn-primary">Suscribirme</button>
                </form>
            </div>
            <!-- Decor -->
            <div class="absolute -top-1/2 -right-1/4 w-[500px] h-[500px] bg-primary/10 blur-[120px] rounded-full">
            </div>
        </div>
    </div>
</section>
</div>

<style>
    @keyframes lxMarquee {
        0% {
            transform: translateX(0);
        }

        100% {
            transform: translateX(-50%);
        }
    }

    .animate-lxMarquee {
        display: flex;
        width: max-content;
        animation: lxMarquee 30s linear infinite;
    }

    .will-change-transform {
        will-change: transform;
    }
</style>
{% endblock %}

{% block extra_js %}
<script>
    // Configuración escalable para el Hero
    const heroConfig = {
        data: [
            {% if featured_laptops %}
    {% for laptop in featured_laptops %}
    {
        brand: "{{ laptop.brand.name if laptop.brand else 'Premium' }}",
            model: "{{ laptop.model.name|replace('\"', '\\\"') if laptop.model else 'Laptop' }}",
                desc: "{{ laptop.short_description[:180]|replace('\"', '\\\"') if laptop.short_description else (laptop.description[:180]|replace('\"', '\\\"') if laptop.description else 'Rendimiento y diseño unidos.') }}",
                    specs: {
            cpu: "{{ (laptop.processor_full_name or laptop.processor.name)|replace('\"', '\\\"') }}",
                gpu: "{{ (laptop.discrete_gpu_full_name or laptop.onboard_gpu_full_name or (laptop.graphics_card.name if laptop.graphics_card else 'Integrada'))|replace('\"', '\\\"') }}",
                    screen: "{{ (laptop.screen_full_name or laptop.screen.name)|replace('&#34;', '\"')|replace('\"', '\\\"') }}",
                        ram: "{{ (laptop.ram_full_name or laptop.ram.name)|replace('\"', '\\\"') }}",
                            storage: "{{ (laptop.storage_full_name or laptop.storage.name)|replace('\"', '\\\"') }}"
        },
        priceNew: "{{ '{:,.0f}'.format(laptop.discount_price or laptop.sale_price) }}",
            priceOld: "{{ '{:,.0f}'.format(laptop.sale_price) if laptop.discount_price else '' }}",
                image: "{% if laptop.images|length > 0 %}{% set cover = (laptop.images|selectattr('is_cover', 'equalto', True)|first or laptop.images[0]) %}{{ url_for('static', filename=cover.image_path) }}{% else %}null{% endif %}",
                    link: "{{ url_for('public.product_detail', id=laptop.id) }}"
    } {% if not loop.last %}, {% endif %}
    {% endfor %}
    {% endif %}
        ],
    currentIndex: 0,
        isAnimating: false,
            timer: null
    };

    function updateHero() {
        if (!heroConfig.data || heroConfig.data.length === 0) return;

        const item = heroConfig.data[heroConfig.currentIndex];
        const imageWrap = document.getElementById('hero-image-wrap');
        const heroImage = document.getElementById('hero-image');

        if (!item || !imageWrap) return;

        // Salida
        imageWrap.classList.add('opacity-0', 'scale-95');

        setTimeout(() => {
            // Textos básicos
            document.getElementById('hero-brand').textContent = item.brand || 'Premium';
            document.getElementById('hero-model').textContent = item.model || 'Laptop';
            document.getElementById('hero-desc').textContent = item.desc || '';

            // Specs
            if (item.specs) {
                const decode = (h) => {
                    const t = document.createElement('textarea');
                    t.innerHTML = h;
                    return t.value;
                };
                document.getElementById('spec-cpu').textContent = decode(item.specs.cpu || '--');
                document.getElementById('spec-gpu').textContent = decode(item.specs.gpu || '--');
                document.getElementById('spec-screen').textContent = decode(item.specs.screen || '--');
                document.getElementById('spec-ram').textContent = decode(item.specs.ram || '--');
                document.getElementById('spec-ssd').textContent = decode(item.specs.storage || '--');
            }

            // Precios
            const priceNewEl = document.getElementById('price-new');
            const priceOldEl = document.getElementById('price-old');

            if (priceNewEl) priceNewEl.textContent = item.priceNew || '--';
            if (priceOldEl) {
                if (item.priceOld) {
                    priceOldEl.textContent = 'RD$ ' + item.priceOld;
                    priceOldEl.classList.remove('hidden');
                } else {
                    priceOldEl.classList.add('hidden');
                }
            }

            // Imagen y Link con Fallback consolidado
            const heroFallback = document.getElementById('hero-fallback');
            if (heroImage && item.image && item.image !== 'null' && item.image !== '') {
                heroImage.src = item.image;
                heroImage.classList.remove('opacity-0', 'hidden');
                if (heroFallback) heroFallback.classList.add('hidden');
            } else if (heroImage) {
                heroImage.classList.add('hidden');
                if (heroFallback) {
                    heroFallback.classList.remove('hidden');
                    heroFallback.classList.add('flex');
                }
            }
            const buyBtn = document.getElementById('buy-btn');
            if (buyBtn && item.link) buyBtn.href = item.link;

            // Update dot indicators
            updateDotIndicators();

            // Entrada
            imageWrap.classList.remove('opacity-0', 'scale-95');
            heroConfig.isAnimating = false;
        }, 300);
    }

    function updateDotIndicators() {
        const dots = document.querySelectorAll('.carousel-dot');
        dots.forEach((dot, index) => {
            if (index === heroConfig.currentIndex) {
                dot.classList.remove('bg-gray-400', 'w-1.5');
                dot.classList.add('bg-purple-600', 'w-6');
            } else {
                dot.classList.remove('bg-purple-600', 'w-6');
                dot.classList.add('bg-gray-400', 'w-1.5');
            }
        });
    }

    function goToSlide(index) {
        if (heroConfig.isAnimating) return;
        heroConfig.isAnimating = true;
        heroConfig.currentIndex = index;
        resetTimer();
        updateHero();
    }

    function manualNext() {
        if (heroConfig.isAnimating) return;
        heroConfig.isAnimating = true;
        heroConfig.currentIndex = (heroConfig.currentIndex + 1) % heroConfig.data.length;
        resetTimer();
        updateHero();
    }

    function manualPrev() {
        if (heroConfig.isAnimating) return;
        heroConfig.isAnimating = true;
        heroConfig.currentIndex = (heroConfig.currentIndex - 1 + heroConfig.data.length) % heroConfig.data.length;
        resetTimer();
        updateHero();
    }

    function resetTimer() {
        clearInterval(heroConfig.timer);
        heroConfig.timer = setInterval(manualNext, 6000);
    }

    // Scroll Observer for reveals
    const revealObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('active');
            }
        });
    }, { threshold: 0.1 });

    document.addEventListener('DOMContentLoaded', () => {
        updateHero();
        resetTimer();

        document.querySelectorAll('.reveal').forEach(el => revealObserver.observe(el));

        // Show desktop arrow buttons on hero hover
        const heroSection = document.querySelector('.hero-gradient');
        const arrowButtons = document.querySelectorAll('#hero-controls > button');

        if (heroSection && arrowButtons.length > 0) {
            heroSection.addEventListener('mouseenter', () => {
                arrowButtons.forEach(btn => btn.classList.remove('opacity-0'));
                arrowButtons.forEach(btn => btn.classList.add('opacity-100'));
            });

            heroSection.addEventListener('mouseleave', () => {
                arrowButtons.forEach(btn => btn.classList.remove('opacity-100'));
                arrowButtons.forEach(btn => btn.classList.add('opacity-0'));
            });
        }
    });
</script>
{% endblock %}